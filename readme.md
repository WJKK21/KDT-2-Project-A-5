# 5조 hz(헤르츠)
- 프로젝트 명(가제) : StockTogether
## 구성인원
|구성|이름|
|:--:|:---|
|팀장|곽윤호|
|팀원|박달재|
||장루빈|
||권예준|
||박준형|
||임지성|

## 목차
- [프로젝트 소개](#프로젝트-소개)
  - [서비스 개요](#1-서비스-개요)
  - [서비스](#2-서비스)
  - [필요 기능](#3-필요-기능)
- [애플리케이션 동작 방식](#stocktogether-동작-방식)
  - [주식 데이터 제공](#1-주식-데이터-제공)
  - [뉴스 데이터 제공](#2-뉴스-데이터-제공)
  - [사용자 생성 / 인가](#3-사용자-생성--인가)
  - [택시 생성](#4-택시-생성)
  - [택시 동승](#5-택시-동승)
  - [택시 출발](#6-택시-출발)
  - [운행종료 - 도착](#7-운행-종료---도착)
  - [운행종료 - 기간만료](#8-운행종료---기간만료)
- [진행 상황](#진행-상황)
  - [프로젝트 설계](#1-프로젝트-설계)
  - [개발환경 구축](#2-개발환경-구축)
  - [데이터베이스](#3-데이터베이스)
  - [App-Front](#4-애플리케이션-제작---view-part)
  - [App-Back](#5-애플리케이션-제작---data-part)

## 프로젝트 소개
- [서비스 개요](#1-서비스-개요)
- [서비스](#2-서비스)
- [필요 기능](#3-필요-기능)

### 1. 서비스 개요
-  stock(주식) + together(함께) 라는 뜻으로
  - 주식을 다른 사람들과 함께 할 수 있는 애플리케이션을 제작하고 있습니다.
### 2. 서비스
- StockTogether애플리케이션에서는 다음과 같은 서비스를 계획하고 있습니다.

__*1. 실시간 주식 데이터 확인*__

__*2. 다른 사람들과 함께 하는 주식*__
- StockTogether에서는 나만의 '택시'를 만들 수 있습니다.  
- StockTogether의 택시에서는 종목, 출발가격, 목표가격등을 설정하여 내가 하고자 하는 투자에 다른 참여자를 모집할 수 있습니다.
- 사용자는 다른 사람이 만든 택시에 동승할 수 있습니다.
### 3. 필요 기능
__*1. 적절한 API 생성 및 활용*__
- SPA, 주식 데이터, 뉴스, 사용자 생성/인가, 택시 정보

__*2. 주식 데이터 가공*__
- 주식 데이터 수치화, 수치화 된 데이터 차트로 출력 및 비교 출력

__*3. DB 구축*__
- 사용자 정보, 사용자가 생성한 택시 데이터, 택시에 동승한 사용자 정보 등 데이터를 관리하기 위한 DB구축

__*4. React - Single Page Application*__
- 서버 부하 감소 및 사용자 경험을 위한 SPA형식의 애플리케이션을 생성을 목표로 하였음
- 생산성이 높은 javascript와 javascript의 단점을 보완할 typescript도입 및 javascript기반 SPA생성 라이브러리로 React를 사용

## StockTogether 동작 방식
  - [주식 데이터 제공](#1-주식-데이터-제공)
  - [뉴스 데이터 제공](#2-뉴스-데이터-제공)
  - [사용자 생성 / 인가](#3-사용자-생성--인가)
  - [택시 생성](#4-택시-생성)
  - [택시 동승](#5-택시-동승)
  - [택시 출발](#6-택시-출발)
  - [운행종료 - 도착](#7-운행-종료---도착)
  - [운행종료 - 기간만료](#8-운행종료---기간만료)
### _1. 주식 데이터 제공_
1. AppServer에서 Alpha Vantage API를 활용하여 주식 데이터 요청
2. AppServer는 Web Socket Server로 주식 데이터를 갱신하여 주기적으로 전송
3. Client는 주식 데이터가 필요한 작업에서 Web Socket으로 주식 데이터를 제공 받아서 가공후 출력
### _2. 뉴스 데이터 제공_
1. AppServer는 클라이언트에게서 "/news"요청이 왔을 경우 Naver News API를 활용하여 뉴스 데이터를 요청
- 클라이언트 사이드로 작성하려 하였으나, Naver API를 활용하는 것에 secret Key가 필요하기에 서버에서 요청하는 것으로 작성
2. 뉴스 데이터를 응답 받았을 경우 응답 받은 데이터를 요청하였던 클라이언트에게 데이터 전송
3. 뉴스 데이터를 응답 받은 클라이언트는 두 가지 방식으로 화면에 출력
- Thumbnail 방식 : 메인 화면의 작은 컨텐츠 박스로 표현하는 방식
  - 기사의 썸네일, 타이틀만 제공 -> 해당 박스를 클릭하면 View 페이지 출력
- View 페이지 방식 : 기사의 타이틀, 본문을 별도의 모달 or View 컴포넌트로 출력
### _3. 사용자 생성 / 인가_
1. 회원 정보가 없는 사용자는 회원 등록을 하기 위해 AppServer로 사용자 정보 전송
2. 회원 정보가 있는 사용자는 서비스 인가를 받기 위해 AppServer로 사용자 정보를 전송 ->  
  AppServer는 DataBase Server로 전송받은 사용자가 있는지 확인 ->  
  사용자가 입력한 정보와 DB에 저장된 정보가 일치한다면 사용자에게 서비스 사용을 인가
### _4. 택시 생성_
1. 사용자는 자신의 투자 방식(ex. "나는 삼성전자가 4500원이 되었을때 투자를 시작하고 5000원이 되었을 때 주식을 팔겠습니다")에 대한 데이터를 AppServer로 전송
2. AppServer는 사용자로부터 받은 데이터(이하 '택시'데이터라고 지정)를 데이터베이스의 'taxi'테이블에 저장
### _5. 택시 동승_
1. 사용자는 운행중인 택시 데이터를 AppServer에 요청
2. AppServer는 DataBase Server에 'taxi'테이블 중 출발하지 않은 택시 데이터를 요청 : 운행중인 택시 = coulmn(state) : value(before)
4. 택시 리스트를 보고 동승하고자 하는 택시에 동승 요청
5. AppServer에서는 사용자와 연동된 계좌에 결제가 가능한 금액이 있는지 확인(설계가 더 필요함)
6. 해당 데이터에 해당하는 데이터베이스에 동승자 배열을 JSON형식으로 insert
### _6. 택시 출발_
1. AppServer는 Alpha Vantage로부터 받은 주식 데이터가 갱신될 때 마다 택시 테이블을 조회
2. 만약 택시 데이터 중 '출발 희망가'가 제공 받은 두식 데이터의 '현재가'와 동일하다면 주식 시장에 거래 신청후 택시 state를 'running'로 변경
### _7. 운행 종료 - 도착_
1. 주식 데이터가 갱신 될 때, 현재 'running' state를 가지고 있는 택시를 조회
2. 만약 택시 데이터 중 '종료 희망가'가 '현재가'와 동일하다면 주식 시장에 거래 신청 후 택시 state를 'stopped'로 변경
### _8. 운행종료 - 기간만료_
- 두 가지 케이스로 나누어 작성
1. 운행 전 모집기간 동안 '현재가'와 '출발 희망가'가 사용자가 지정한 기간 날짜안에 일치되지 않은 경우
- 택시 state를 'stopped'로 변경
2. 운행 중 '현재가'와 택시 생성자가 지정한 '폭파 희망가'가 동일한 경우
- 주식 시장에 거래 신청 후 택시 state를 'stopped'로 변경

## 진행 상황
- [프로젝트 설계](#1-프로젝트-설계)
- [개발환경 구축](#2-개발환경-구축)
- [데이터베이스](#3-데이터베이스)
- [App-Front](#4-애플리케이션-제작---view-part)
- [App-Back](#5-애플리케이션-제작---data-part)


### *1. 프로젝트 설계*
> 2023.05.25
1. 설계서 작성
- 서비스 개발에 필요한 기능 분석
- 애플리케이션 와이어프레임 및 목업 제작
> 2023.05.26
1. 설계서 작성
- 사이트맵 블록 다이어그램 제작
- 폴더링 블록 다이어그렘 제작
- 기능별 요구사항 정리
- 기능 분석 및 상세 설정

### *2. 개발환경 구축*
> 2023.05.24
1. Typescript 셋업
2. express 프레임워크 셋업
3. 프로젝트 폴더 아키텍팅
> 2023.05.30
1. React 셋업
- CRA(Create-React-App)명령어 없이 직접 React환경 구축하기
- webpack(번들링), babel(컴파일러) 셋업
> 2023.05.31
1. react의 Hook과 Typescript의 제네릭으로 props의 타입 선언
> 2023.06.01
1. js, jsx의 파일을 ts, tsx로 변환 작업
> 2023.06.02
1. 프로젝트 폴더 아키텍팅 변경
- 클라이언트가 직접 보는 형태에 관여하는 파일 : src/views 디렉토리로 이동
- 클라이언트가 직접 볼 수 없는 형태의 파일 : /root/utils 디렉토리로 이동

### *3. 데이터베이스*
> 2023.05.31
1. 주식 샘플 데이터 저장 - *(임의의 주식 API)*
> 2023.06.05
1. user_info 테이블 생성 - *(회원 테이블)*
> 2023.06.09
1. taxi 테이블 생성
- status의 datatype: ENUM시도 하였으나 실패

### *4. 애플리케이션 제작 - View Part*
> 2023.06.01
1. 애플리케이션의 공통 UI 중 헤더, 네비 컴포넌트를 제작
2. Hook을 사용하여 동적으로 데이터의 길이만큼 Box를 생성하는 함수 제작
> 2023.06.02
1. 컴포넌트 파일 명 변경 : 

```createBox.tsx``` -> ```contentBoxLayout.tsx```

```magicBox.tsx``` -> ```contentBox.tsx```
2. Nav메뉴에서 아이콘을 클릭했을 때 url path 변경
- path에 맞는 컴포넌트 출력을 위해 React - Router 사용
> 2023.06.05
1. 회원가입 컴포넌트 생성
2. 로그인 컴포넌트 생성
3. Nav컴포넌트를 숨기기 / 나타내기
- useLocation 훅을 사용하여 현재 path를 읽음
- 일부 path에서 Nav 컴포넌트를 출력하지않도록 설정
4. 최초 페이지 생성
- 로그인, 회원가입 버튼이 있는 최초 페이지 생성
5. CSS 모듈 생성
- .d.ts 확장자 파일에 CSS해석 타입 지정
- 각 컴포넌트마다 해당 페이지의 CSS 적용
> 2023.06.07
1. 데이터의 양을 기준으로 자동 생성되는 contentBox 생성
- main 컴포넌트에 해당 로직을 작성하였음
> 2023.06.08
1. 뉴스 데이터를 받아서 컴포넌트에 출력
- HTML엔티티가 해석되지 않는 문제 수정
- contentBox에 담아 표기하기까지 성공
> 2023.06.09
1. 뉴스 contentBox CSS 디자인
- 썸네일 / 타이틀 두 구역으로 나누어 박스 스타일링
2. 제공받은 주식 데이터를 기반으로 차트 생성 성공
- 성공은 하였으나 새로운 데이터를 받았을 때 모든 차트가 재생성 됨
- 원하는 모습 : 그래프의 마지막에 새로운 요소를 '추가'하는 식으로 구현하여야 함

### *5. 애플리케이션 제작 - Data Part*
> 2023.06.01
1. axios 라이브러리를 활용 AJAX -> AppServer로부터 주식 데이터 요청 생성
2. AppServer 제작 : express 프레임워크 활용
> 2023.06.02
1. 주식 데이터를 컴포넌트에 출력하는 것 성공
- 실시간 데이터를 원하였으나 제약사항이 있어 우선 전일(정적)데이터로 출력
2. 주식 데이터가 갱신될 때 마다 DB에 삽입하는 것 성공
> 2023.06.05
1. 회원가입 API 생성
- '/creataccount' url => POST : *'/user' url => POST로 변경 계획
2. naver 뉴스 API 사용 - *(AppServer에서)*
- '경제'관련 실시간 뉴스 데이터를 받아오는 것에 성공
3. 주식 데이터를 WebSocket으로 받아올 준비 중
> 2023.06.07
1. Web Socket을 활용하여 AppServer로부터 주기적으로 주식데이터를 전송 받음
- AppServer는 주식 데이터 API를 활용하여 주식 데이터를 갱신
- AppServer의 주식 데이터가 갱신될 때 마다 클라이언트에게 Web Socket으로 주식 데이터 전송
> 2023.06.08
1. 로그인 API 생성
- '/signin' url => POST
2. Web Socket으로 전송받는 데이터 Hook을 사용하여 하위 컴포넌트에게 전달
- 데이터를 전달까지는 하였으나 Typescript에서 Type에러 발생
3. News 데이터 가공
- 제공받은 뉴스 데이터 중 원문 링크에서 썸네일, 타이틀을 크롤링하는 모듈 생성
- 크롤링 모듈에서 문제점 : 비 정형화, 비 구조화 된 데이터를 가져오기 위해 알고리즘을 작성해야 함
4. ```stockContentsBox.tsx```수정
- 소켓연결, 주식데이터 받기, 주식 데이터 태그 생성 역할을 한 컴포넌트에서 수행했었음
- ```App.tsx```에 socket을, 주식 데이터는 Context를 활용하여 넘김
> 2023.06.09
1. 매일 마지막 주식 데이터를 기반으로 동적으로 테이블 생성
- 금일 마지막 주식 데이터를 자동으로 삽입하도록 작성
2. 전일 저장된 데이터와 현재가를 비교하는 모듈 작성